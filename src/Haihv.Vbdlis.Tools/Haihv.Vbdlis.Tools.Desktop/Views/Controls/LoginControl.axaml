<UserControl
  x:Class="Haihv.Vbdlis.Tools.Desktop.LoginControl"
  xmlns="https://github.com/avaloniaui"
  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
  xmlns:vm="using:Haihv.Vbdlis.Tools.Desktop.ViewModels"
  d:DesignHeight="350"
  d:DesignWidth="450"
  x:DataType="vm:LoginViewModel"
  mc:Ignorable="d">

  <Design.DataContext>
    <vm:LoginViewModel />
  </Design.DataContext>

  <UserControl.Resources>
    <SolidColorBrush x:Key="PrimaryButtonBackgroundBrush" Color="#0F6CBD" />
    <SolidColorBrush x:Key="PrimaryButtonForegroundBrush" Color="#FFFFFF" />
    <SolidColorBrush x:Key="WarningButtonBackgroundBrush" Color="#D13438" />
    <SolidColorBrush x:Key="WarningButtonForegroundBrush" Color="#FFFFFF" />
  </UserControl.Resources>

  <UserControl.Styles>
    <Style Selector="Button.primary">
      <Setter Property="Background" Value="{StaticResource PrimaryButtonBackgroundBrush}" />
      <Setter Property="Foreground" Value="{StaticResource PrimaryButtonForegroundBrush}" />
      <Setter Property="BorderBrush" Value="{StaticResource PrimaryButtonBackgroundBrush}" />
    </Style>
    <Style Selector="Button.warning">
      <Setter Property="Background" Value="{StaticResource WarningButtonBackgroundBrush}" />
      <Setter Property="Foreground" Value="{StaticResource WarningButtonForegroundBrush}" />
      <Setter Property="BorderBrush" Value="{StaticResource WarningButtonBackgroundBrush}" />
    </Style>
  </UserControl.Styles>

  <Border
    MinWidth="400"
    Padding="16"
    Background="{DynamicResource SystemRegionBrush}"
    BorderBrush="{DynamicResource SystemControlForegroundBaseMediumBrush}"
    BorderThickness="1"
    CornerRadius="8">

    <StackPanel Spacing="8">

      <!--  Header  -->
      <TextBlock
        Margin="0,0,0,10"
        HorizontalAlignment="Center"
        FontSize="24"
        FontWeight="Bold"
        Text="Đăng nhập" />

      <!--  Server Input  -->
      <Grid ColumnDefinitions="Auto,*">
        <TextBlock
          Grid.Column="0"
          Width="88"
          VerticalAlignment="Center"
          FontWeight="SemiBold"
          Text="Máy chủ:" />
        <TextBox
          Grid.Column="1"
          IsEnabled="{Binding !IsLoggingIn}"
          Text="{Binding Server}"
          Watermark="Nhập địa chỉ máy chủ (vd: https://example.com)" />
      </Grid>

      <!--  Username Input  -->
      <Grid ColumnDefinitions="Auto,*">
        <TextBlock
          Grid.Column="0"
          Width="88"
          VerticalAlignment="Center"
          FontWeight="SemiBold"
          Text="Tài khoản:" />
        <TextBox
          Grid.Column="1"
          IsEnabled="{Binding !IsLoggingIn}"
          Text="{Binding Username}"
          Watermark="Nhập tên tài khoản" />
      </Grid>

      <!--  Password Input  -->
      <Grid ColumnDefinitions="Auto,*">
        <TextBlock
          Grid.Column="0"
          Width="88"
          VerticalAlignment="Center"
          FontWeight="SemiBold"
          Text="Mật khẩu:" />
        <TextBox
          Grid.Column="1"
          IsEnabled="{Binding !IsLoggingIn}"
          PasswordChar="●"
          Text="{Binding Password}"
          Watermark="Nhập mật khẩu" />
      </Grid>

      <Grid ColumnDefinitions="Auto,*,Auto" ColumnSpacing="8">
        <!--  Headless Browser Checkbox  -->
        <CheckBox
          Grid.Column="0"
          Content="Ẩn trình duyệt"
          IsChecked="{Binding HeadlessBrowser}"
          IsEnabled="{Binding !IsLoggingIn}" />
        <!--  Remember Me Checkbox  -->
        <CheckBox
          Grid.Column="2"
          Content="Lưu thông tin đăng nhập"
          IsChecked="{Binding RememberMe}"
          IsEnabled="{Binding !IsLoggingIn}" />
      </Grid>

      <!--  Error Message  -->
      <TextBlock
        Foreground="Red"
        IsVisible="{Binding ErrorMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
        Text="{Binding ErrorMessage}"
        TextWrapping="Wrap" />

      <!--  Buttons  -->
      <Grid ColumnDefinitions="*,*" ColumnSpacing="9">

        <!--  Login Button  -->
        <Button
          Grid.Column="0"
          HorizontalAlignment="Stretch"
          HorizontalContentAlignment="Center"
          Classes="primary"
          Command="{Binding LoginCommand}"
          Content="Đăng nhập" />

        <!--  Cancel Button  -->
        <Button
          Grid.Column="1"
          HorizontalAlignment="Stretch"
          HorizontalContentAlignment="Center"
          Classes="warning"
          Command="{Binding CancelCommand}"
          Content="Thoát chương trình"
          IsEnabled="{Binding !IsLoggingIn}" />
      </Grid>

      <!--  Loading Indicator  -->
      <StackPanel IsVisible="{Binding IsLoggingIn}" Spacing="8">
        <ProgressBar
          Height="6"
          CornerRadius="3"
          IsIndeterminate="True" />
        <TextBlock
          HorizontalAlignment="Center"
          FontStyle="Italic"
          IsVisible="{Binding LoginStatusMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}"
          Text="{Binding LoginStatusMessage}" />
      </StackPanel>

    </StackPanel>
  </Border>
</UserControl>
